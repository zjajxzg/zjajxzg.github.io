---
title: redis设计与实现
date: 2020-03-14 18:11:21
categories: 数据库
tags: redis
---

### 《redis设计与实现》

#### 第一部分-数据结构与对象

##### 一、简单动态字符串（SDS）

```c
struct sdshde {
	// 记录buf数组中已经使用字节的数量
    // 等于SDS所保存字符串的长度
    int len;
    // 记录buf数组中未使用字节的数量
    int free;
    // 字节数组，用于保存字符串
    char buf[];

}
```

<!-- more -->

相比与C字符串的优势：

- 常数复杂度获取字符串长度
- 杜绝缓冲区溢出
- 减少修改字符串时带来的内存重分配次数
  - 空间预分配（len小于1m: free=len，len>1m: free=1m）
  - 惰性空间释放
- 二进制安全（使用len来判断字符串结束，而不是结尾的空字符串）

- 兼容部分C字符串函数